function gerarID() {
    return dados.length > 0 ? Math.max(...dados.map(d => d.id)) + 1 : 1;
}

function formatarDataBR(dataISO) {
    if (!dataISO) return "";
    const [ano, mes, dia] = dataISO.split("-");
    return `${dia}/${mes}/${ano}`;
}

function renderizar() {
    tabela.innerHTML = "";
    const filtroNome = document.getElementById("filtroNome").value.toLowerCase();
    const filtroSetor = document.getElementById("filtroSetor").value.toLowerCase();
    const filtroStatus = document.getElementById("filtroStatus").value;

    const hoje = new Date().toISOString().split('T')[0];

    const filtrados = dados.filter(item =>
        item.nome.toLowerCase().includes(filtroNome) &&
        item.setor.toLowerCase().includes(filtroSetor) &&
        (filtroStatus === "" || item.status === filtroStatus)
    );

    filtrados.forEach((item, index) => {
        const row = document.createElement("tr");
        let statusClass = "";
        let statusText = item.status;

        if (item.status === "Em andamento") {
            statusClass = "status-em-andamento";
        }
        if (item.prazo < hoje && item.status !== "ConcluÃ­do") {
            statusClass = "atrasado";
            statusText = "Atrasado";
        }

        row.innerHTML = `
            <td>${item.id}</td>
            <td>${formatarDataBR(item.data)}</td>
            <td>${item.nome}</td>
            <td>${item.descricao}</td>
            <td>${item.setor}</td>
            <td>${formatarDataBR(item.prazo)}</td>
            <td>${item.responsavel}</td>
            <td class="${statusClass}">${statusText}</td>
            <td>
                <button onclick="editar(${index})">Editar</button>
                <button onclick="deletar(${index})">Excluir</button>
            </td>
        `;
        tabela.appendChild(row);
    });
    localStorage.setItem('atividades', JSON.stringify(dados));
}


